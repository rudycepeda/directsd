<html><head><title>Optimal disturbance attenuation  :: Examples (DirectSD Toolbox)</title>
<link rel=stylesheet href="../dsd.css" type="text/css">
</head>
<body bgcolor=#ffffff>

<table border=0 width="100%" cellpadding=0 cellspacing=0><tr>
<td valign=baseline bgcolor="#e7ebf7"><b>DirectSD Toolbox</b></td>
<td valign=baseline bgcolor="#e7ebf7" align=right>
<a href="demo_at96.html"><img src="../images/b_prev.gif" alt="Previous page" 
border=0></a>&nbsp;&nbsp;&nbsp;<a href="demo_doubint.html"><img 
src="../images/b_next.gif" alt="Next Page" border=0></a></td>
</tr>
</table>


<H2>Example: Optimal disturbance attenuation</H2>
<H3>Statement of the problem</H3>
Consider the stabilization system shown in the following
figure:
<CENTER><IMG SRC="images/aut97_schema.gif" WIDTH=353 HEIGHT=118 ALT=""></CENTER>
Plant is modelled as a linear continuous-time system
with transfer function
<CENTER><IMG SRC="images/aut97_f.gif" WIDTH=117 HEIGHT=45 ALT=""></CENTER>
Disturbance acting at the plant input is described as
a stationary centered stochastic process with spectral density
<CENTER><IMG SRC="images/aut97_sw.gif" WIDTH=131 HEIGHT=42 ALT=""></CENTER>
In the figure, <span class=tms>w</span> is a unit white noise and
<span class=tms>F<SUB>w</SUB></span> denotes the corresponding shaping filter
with transfer function
<CENTER><IMG SRC="images/aut97_fw.gif" WIDTH=117 HEIGHT=45 ALT=""></CENTER>
Digital controller incorporates a sampling unit
with period <span class=tms>T&nbsp;=&nbsp;0.2</span>,
digital filter <span class=tms>K</span> and
a zero-order hold <span class=tms>H</span>. There is a computational delay
<span class=tms>&#964;&nbsp;=&nbsp;0.093</span>, which is to be taken into account.
<p>
The command signal <span class=tms>r</span> is so far assumed to be zero.
It is required to find transfer function of the optimal
controller <span class=tms>K</span> that minimizes the average variance
of the error <span class=tms>&#949;</span> over continuous time.

<H3>Preparing data</H3>
The known data can be entered as follows:
<pre>
   F = tf ( [1 0.5], [1 -1 0] );
   Fw = tf( 2, [1 2] );
   T  = 0.2;
</pre>
As for the computational delay, it should be formally
included in an LTI model:
<pre>
   F1 = tf ( 1 );
   F1.iodelay = 0.093;
</pre>
Therefore, for <span class=tms>r&nbsp;=&nbsp;0</span> operator equations of
the system can be written in the form:
<CENTER><IMG SRC="images/aut97_opeq.gif" WIDTH=212 HEIGHT=45 ALT=""></CENTER>
so that
<CENTER><IMG SRC="images/aut97_pij.gif" WIDTH=287 HEIGHT=55 ALT=""></CENTER>
and the plant for the standard system can be
constructed as
<pre>
   sys = [ F*Fw  F*F1
          -F*Fw -F*F1]

sys: transfer function 2 x 2

    !     2 s + 1                         s + 0.5 !
    ! ---------------    exp(-0.093*s) *  ------- !
    ! s^3 + s^2 - 2 s                     s^2 - s !
    !                                             !
    !     -2 s - 1                       -s - 0.5 !
    ! ---------------    exp(-0.093*s) * -------- !
    ! s^3 + s^2 - 2 s                     s^2 - s !
</pre>

<H3>Optimization</H3>
Since system output is a continuous-time signal,
it is reasonable to minimize average variance of the error.
For this purpose we use
<A HREF="../functions/sdh2.html">sdh2</A>
<pre>
   K = sdh2 ( sys, T )

K: zero-pole-gain model 1 x 1

       14.1985 z (z-0.914) (z-0.463)
      -------------------------------
      (z+0.8674) (z-0.905) (z-0.6638)

Sampling time: 0.2
</pre>
<H3>Analysis</H3>
Compute the mean square error by means of
<A HREF="../functions/sdh2norm.html">sdh2norm</A>
<pre>
   err = sdh2norm ( sys, K )

err =
    0.1840
</pre>
Setting the third optional parameter to 0, we
compute the variance at the sampling instants:
<pre>
   err0 = sdh2norm ( sys, K, 0 )

err0 =
    0.1600
</pre>

<H3>Comparison with discrete-time optimization</H3>
For comparison, we find the controller that minimize
the error at the sampling instants:
<pre>
   K0 = sdh2 ( sys, T, 0 )

K0: zero-pole-gain model 1 x 1

      19.2942 z (z-0.9111) (z-0.4004)
      -------------------------------
      (z+1.006) (z-0.9049) (z-0.6703)

Sampling time: 0.2
</pre>
Notice that this controller is quite different from
the previous. Average error variance
<pre>
   err = sdh2norm ( sys, K0 )

err =
    0.9245
</pre>
is a more than 5 times higher than for the optimal
controller, though the mean error at the sampling points
<pre>
   err0 = sdh2norm ( sys, K0, 0 )

err0 =
    0.1364
</pre>
is lower than for the previous variant.
Computing the error for the time grid over the
sampling interval, we can compare the curves for
the two filters:
<pre>
   t = [0:0.025:1]*T;
   err_t = sdh2norm ( sys, K, t )
   err_t0 = sdh2norm ( sys, K0, t );
   plot ( t, err_t, t, err_t0, '--' );
</pre>
<CENTER><IMG SRC="images/aut97_varcmp.jpg" vspace="5" WIDTH=311 HEIGHT=294 ALT=""></CENTER>
The curves show that the controller
<span class=tms>K<SUB>0</SUB></span>
causes intersample ripples, and the variance is very
high inside the interval. By simulation it can be verified
that hidden oscillations occur with controller
<span class=tms>K<SUB>0</SUB></span>
under unit step applied to the input <span class=tms>r</span>.
Therefore, it is recommended to use direct design methods.

<H3>References</H3>
<p><A name="ref1"></A>[1]&nbsp;
Y.N. Rosenwasser, K.Y. Polyakov, and B.P. Lampe,
Frequency-domain method for <I>H</I><SUB>2</SUB>-optimization of time-delayed
sampled-data systems, <I>Automatica</I>, 1997, vol. 32, no. 7,
pp. 1387-1392.
</p>


<p><table bgcolor="#e7ebf7" border=0 width="100%" cellpadding=0 cellspacing=0>
<tr valign=top><td align=left width=20>
<a href="demo_at96.html"><img src="../images/b_prev.gif" alt="Previous page" border=0 
align=bottom></a>&nbsp;</td>
<td align=left>&nbsp;Optimal ship course stabilization</td><td>&nbsp;</td>
<td align=right>Optimal control for double integrator &nbsp;</td>
<td align=right width=20><a href="demo_doubint.html"><img src="../images/b_next.gif" alt="Next 
page" border=0 align=bottom></a></td>
</tr></table>
<p class="copy" align="right">Copyright &copy; 1999-2006 K. Polyakov.</p>

</body>
</html>


